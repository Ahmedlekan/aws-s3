# AWS Key Management Service (KMS)

AWS Key Management Service (KMS) is a fully managed service that makes it easy to create, store, and manage cryptographic keys. It provides a secure and scalable solution for encrypting data and managing access to encryption keys. Below is a detailed explanation of KMS, its features, and best practices for using it effectively.

## Key Features

Regional and Public Service:

- KMS is a regional service, meaning keys are isolated to the region where they are created.

- It is a public service, accessible via AWS APIs, CLI, and SDKs.

Key Management:

- Create, store, and manage symmetric and asymmetric keys.

- Perform cryptographic operations such as encryption, decryption, signing, and verification.

Security:

- Keys never leave KMS; all cryptographic operations are performed within the service.

- Complies with FIPS 140-2 (Level 2) security standards.

Data Encryption:

- KMS can directly encrypt data up to 4 KB in size.

- For larger data, KMS generates Data Encryption Keys (DEKs).


## KMS Keys

### Logical Structure

KMS keys are logical resources that include:

- Key ID: Unique identifier for the key.

- Creation Date: When the key was created.

- Policy: Defines who can access and manage the key.

- Description: Optional description of the key.

- State: Enabled, disabled, or pending deletion.

### Physical Key Material

Each KMS key is backed by physical key material:

- AWS-Generated: Key material is generated by KMS.

- Customer-Imported: Key material is imported by the customer.


## Data Encryption Keys (DEKs)

### How DEKs Work

Generate Data Key:

- KMS generates a plaintext and ciphertext version of the DEK.

- The plaintext key is used to encrypt data locally.

- The ciphertext key is the encrypted version of the DEK, which can be stored alongside the encrypted data.

Encrypt Data:

- Use the plaintext DEK to encrypt data.

- Discard the plaintext DEK after encryption.

Store Encrypted Data:

- Store the encrypted data and the ciphertext DEK together.

- To decrypt the data, use KMS to decrypt the ciphertext DEK and retrieve the plaintext DEK.

Use Case

DEKs are used for encrypting data larger than 4 KB (e.g., files, databases, or backups).


## Key Concepts

1. Regional Isolation

    KMS keys are isolated to the region where they are created and cannot be transferred to another region.

2. Key Ownership

    AWS-Owned Keys:

      - Managed by AWS and used for services like S3, EBS, and RDS.

      - Customers do not have direct control over these keys.

    Customer-Owned Keys:

      - Managed by the customer.

      - Can be AWS-Managed (created and managed by AWS for specific services) or Customer-Managed (fully controlled by the customer).

3. Key Rotation

    KMS supports automatic key rotation for customer-managed keys:

      - A new backing key is generated annually.

      - The previous backing key is retained for decryption of older data.

      - Key rotation does not require re-encryption of existing data.

4. Aliases

    - Aliases are friendly names for KMS keys (e.g., alias/my-key).

    - Aliases can be updated to point to different keys, simplifying key management.






